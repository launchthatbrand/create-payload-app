{"version":3,"file":"handleTakeOver.js","names":["handleTakeOver","id","collectionSlug","globalSlug","user","isWithinDoc","updateDocumentEditor","setCurrentEditor","documentLockStateRef","isLockingEnabled","setIsReadOnlyForIncomingUser","current","hasShownLockedModal","isLocked","error","console"],"sources":["../../src/utilities/handleTakeOver.tsx"],"sourcesContent":["import type { ClientUser } from 'payload'\n\nexport const handleTakeOver = (\n  id: number | string,\n  collectionSlug: string,\n  globalSlug: string,\n  user: ClientUser | number | string,\n  isWithinDoc: boolean,\n  updateDocumentEditor: (\n    docID: number | string,\n    slug: string,\n    user: ClientUser | number | string,\n  ) => Promise<void>,\n  setCurrentEditor: (value: React.SetStateAction<ClientUser | number | string>) => void,\n  documentLockStateRef: React.RefObject<{\n    hasShownLockedModal: boolean\n    isLocked: boolean\n    user: ClientUser | number | string\n  }>,\n  isLockingEnabled: boolean,\n  setIsReadOnlyForIncomingUser?: (value: React.SetStateAction<boolean>) => void,\n): void => {\n  if (!isLockingEnabled) {\n    return\n  }\n\n  try {\n    // Call updateDocumentEditor to update the document's owner to the current user\n    void updateDocumentEditor(id, collectionSlug ?? globalSlug, user)\n\n    if (!isWithinDoc) {\n      documentLockStateRef.current.hasShownLockedModal = true\n    }\n\n    // Update the locked state to reflect the current user as the owner\n    documentLockStateRef.current = {\n      hasShownLockedModal: documentLockStateRef.current?.hasShownLockedModal,\n      isLocked: true,\n      user,\n    }\n    setCurrentEditor(user)\n\n    // If this is a takeover within the document, ensure the document is editable\n    if (isWithinDoc && setIsReadOnlyForIncomingUser) {\n      setIsReadOnlyForIncomingUser(false)\n    }\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error('Error during document takeover:', error)\n  }\n}\n"],"mappings":"AAEA,OAAO,MAAMA,cAAA,GAAiBA,CAC5BC,EAAA,EACAC,cAAA,EACAC,UAAA,EACAC,IAAA,EACAC,WAAA,EACAC,oBAAA,EAKAC,gBAAA,EACAC,oBAAA,EAKAC,gBAAA,EACAC,4BAAA;EAEA,IAAI,CAACD,gBAAA,EAAkB;IACrB;EACF;EAEA,IAAI;IACF;IACA,KAAKH,oBAAA,CAAqBL,EAAA,EAAIC,cAAA,IAAkBC,UAAA,EAAYC,IAAA;IAE5D,IAAI,CAACC,WAAA,EAAa;MAChBG,oBAAA,CAAqBG,OAAO,CAACC,mBAAmB,GAAG;IACrD;IAEA;IACAJ,oBAAA,CAAqBG,OAAO,GAAG;MAC7BC,mBAAA,EAAqBJ,oBAAA,CAAqBG,OAAO,EAAEC,mBAAA;MACnDC,QAAA,EAAU;MACVT;IACF;IACAG,gBAAA,CAAiBH,IAAA;IAEjB;IACA,IAAIC,WAAA,IAAeK,4BAAA,EAA8B;MAC/CA,4BAAA,CAA6B;IAC/B;EACF,EAAE,OAAOI,KAAA,EAAO;IACd;IACAC,OAAA,CAAQD,KAAK,CAAC,mCAAmCA,KAAA;EACnD;AACF","ignoreList":[]}